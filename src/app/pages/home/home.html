<section class="page">
  <h1>Bienvenido a la Sala de Juegos</h1>

  @if (auth.user$ | async; as u) {
  <div class="home-layout right">
    <article class="card home-card">
      <header class="card__head">
        @if (u.avatar_url) { <img [src]="u.avatar_url" alt="avatar" class="avatar-sm" /> }
        <div>
          <h3>Hola, {{ u.display_name || u.email }}</h3>
          @if (u.age) {
          <p class="muted">Edad: {{ u.age }}</p>
          }
        </div>
      </header>

      <p class="lead">Eleg√≠ un juego para empezar:</p>

      <div class="game-grid">
        <a class="game-tile gt--ahorcado" routerLink="/juegos/ahorcado">
          <div class="game-tile__icon" aria-hidden="true">
            <img class="ahorcado" src="../../../assets/ahorcado.png" alt="" />
          </div>
          <div class="game-tile__text">
            <h4>Ahorcado</h4>
            <small>Descubr√≠ la palabra tocando letras</small>
          </div>
        </a>

        <a class="game-tile gt--mayor" routerLink="/juegos/mayor-menor">
          <div class="game-tile__icon" aria-hidden="true">üÇ°</div>
          <div class="game-tile__text">
            <h4>Mayor o Menor</h4>
            <small>¬øLa pr√≥xima carta ser√° mayor o menor?</small>
          </div>
        </a>

        <a class="game-tile gt--preguntados" routerLink="/juegos/preguntados">
          <div class="game-tile__icon" aria-hidden="true">‚ùì</div>
          <div class="game-tile__text">
            <h4>Preguntados</h4>
            <small>Descubr√≠ los personajes</small>
          </div>
        </a>

        <a class="game-tile gt--simon" routerLink="/juegos/simon">
          <div class="game-tile__icon simon-icon" aria-hidden="true">
            <span></span><span></span><span></span><span></span>
          </div>
          <div class="game-tile__text">
            <h4>Simon</h4>
            <small>Repetir la secuencia de colores</small>
          </div>
        </a>
      </div>

      <app-chat [height]="300"></app-chat>
    </article>

    <mat-card class="side-card">
      <mat-card-header>
        <mat-card-title>Tus √∫ltimos resultados</mat-card-title>
      </mat-card-header>

      <mat-card-content>
        @if (loadingUlt) {
        <div class="mwrap">
          <mat-progress-spinner mode="indeterminate" diameter="32"></mat-progress-spinner>
        </div>
        } @else if (ultimos.length === 0) {
        <div class="empty">
          <mat-icon fontIcon="sports_esports"></mat-icon>
          <p class="muted">Todav√≠a no jugaste.</p>
        </div>
        } @else {
        <div class="table-scroll">
          <table mat-table [dataSource]="ultimos" class="mat-elevation-z1">
            <!-- Juego -->
            <ng-container matColumnDef="juego">
              <th mat-header-cell *matHeaderCellDef>Juego</th>
              <td mat-cell *matCellDef="let r">{{ r.game }}</td>
            </ng-container>

            <!-- Puntaje -->
            <ng-container matColumnDef="puntaje">
              <th mat-header-cell *matHeaderCellDef>Puntaje</th>
              <td mat-cell *matCellDef="let r" class="score">{{ r.score }}</td>
            </ng-container>

            <!-- Fecha -->
            <ng-container matColumnDef="fecha">
              <th mat-header-cell *matHeaderCellDef>Fecha</th>
              <td mat-cell *matCellDef="let r" class="date">
                {{ r.created_at | date : 'dd-MM-yy' }}
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>
        </div>
        }
      </mat-card-content>
    </mat-card>
  </div>
  } @else {
  <div class="card">
    <h3>No est√°s logueado</h3>
    <p class="centrar"><a class="btn btn-entrar" routerLink="/login">Ir a Login</a></p>
  </div>
  }
</section>
